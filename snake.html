<!DOCTYPE html>
<html>
<head>
<style>
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    background-color: white; /* 将背景改为白色 */
    font-family: Arial, sans-serif;
  }
  canvas {
    border: 1px solid black;
  }
</style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="400"></canvas>
<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  const gridSize = 20;
  let snake = [{ x: 2, y: 2 }];
  let food = [];
  let direction = "right";
  let gameInterval;
  let score = 0;
  let foodCount = 1;

  function drawSnake() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    snake.forEach(segment => {
      ctx.fillStyle = "blue";
      ctx.beginPath();
      ctx.arc(segment.x * gridSize + gridSize / 2, segment.y * gridSize + gridSize / 2, gridSize / 2, 0, Math.PI * 2);
      ctx.fill();
    });
  }

  function drawFood() {
    ctx.fillStyle = "red";
    food.forEach(f => {
      ctx.beginPath();
      ctx.arc(f.x * gridSize + gridSize / 2, f.y * gridSize + gridSize / 2, gridSize / 2, 0, Math.PI * 2);
      ctx.fill();
    });
  }

  function drawScore() {
    ctx.fillStyle = "black";
    ctx.font = "20px Arial";
    ctx.fillText(`分数: ${score}`, canvas.width - 100, 30);
  }

  function moveSnake() {
    const newHead = { ...snake[0] };

    switch (direction) {
      case "up":
        newHead.y -= 1;
        break;
      case "down":
        newHead.y += 1;
        break;
      case "left":
        newHead.x -= 1;
        break;
      case "right":
        newHead.x += 1;
        break;
    }

    snake.unshift(newHead);

    for (let i = 0; i < food.length; i++) {
      if (newHead.x === food[i].x && newHead.y === food[i].y) {
        score += 1;
        food.splice(i, 1);
        generateFood();
        break;
      }
    }

    if (snake.length > score + 1) {
      snake.pop();
    }

    drawSnake();
    drawFood();
    drawScore();
  }

  function generateFood() {
    if (food.length < foodCount) {
      const newFood = {
        x: Math.floor(Math.random() * (canvas.width / gridSize)),
        y: Math.floor(Math.random() * (canvas.height / gridSize))
      };
      food.push(newFood);
    }

    if (score >= 10) {
      foodCount = Math.floor(score / 10) + 1;
    }
  }

  function checkCollision() {
    const head = snake[0];

    if (
      head.x < 0 ||
      head.y < 0 ||
      head.x >= canvas.width / gridSize ||
      head.y >= canvas.height / gridSize
    ) {
      clearInterval(gameInterval);
      alert("你真菜!");
    }

    for (let i = 1; i < snake.length; i++) {
      if (snake[i].x === head.x && snake[i].y === head.y) {
        clearInterval(gameInterval);
        alert("你真菜!");
        break;
      }
    }
  }

  function handleKeyPress(event) {
    switch (event.key) {
      case "ArrowUp":
        direction = "up";
        break;
      case "ArrowDown":
        direction = "down";
        break;
      case "ArrowLeft":
        direction = "left";
        break;
      case "ArrowRight":
        direction = "right";
        break;
    }
  }

  function startGame() {
    document.addEventListener("keydown", handleKeyPress);
    generateFood();
    gameInterval = setInterval(() => {
      moveSnake();
      checkCollision();
    }, 150);
  }

  startGame();
</script>
</body>
</html>
