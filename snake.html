<!DOCTYPE html>
<html>
<head>
<style>
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    
            
    background-image: url("back.jpg"); /* 修改为png格式 */
    background-size: cover;
    background-position: center top;
    font-family: Arial, sans-serif;
  }
  canvas {
    border: 1px solid black;
  }
</style>
</head>
<body>
<canvas id="gameCanvas" width="400" height="400"></canvas>
<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  const gridSize = 20;
  let snake = [{ x: 2, y: 2 }];
  let food = { x: [], y: [] };
  let direction = "right";
  let gameInterval;
  let score = 0;
  let foodCount = 1;

  function drawSnake() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    snake.forEach(segment => {
      ctx.fillStyle = "green";
      ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize, gridSize);
    });
  }

  function drawFood() {
    ctx.fillStyle = "red";
    for (let i = 0; i < foodCount; i++) {
      ctx.fillRect(food.x[i] * gridSize, food.y[i] * gridSize, gridSize, gridSize);
    }
  }

  function drawScore() {
    ctx.fillStyle = "black";
    ctx.font = "20px Arial";
    ctx.fillText(`Score: ${score}`, canvas.width - 100, 30);
  }

  function moveSnake() {
    const newHead = { ...snake[0] };

    switch (direction) {
      case "up":
        newHead.y -= 1;
        break;
      case "down":
        newHead.y += 1;
        break;
      case "left":
        newHead.x -= 1;
        break;
      case "right":
        newHead.x += 1;
        break;
    }

    snake.unshift(newHead);

    for (let i = 0; i < foodCount; i++) {
      if (newHead.x === food.x[i] && newHead.y === food.y[i]) {
        score += 1;
        generateFood();
      }
    }

    if (snake.length > score + 1) {
      snake.pop();
    }

    drawSnake();
    drawFood();
    drawScore();
  }

  function generateFood() {
    food = { x: [], y: [] };
    for (let i = 0; i < foodCount; i++) {
      food.x.push(Math.floor(Math.random() * (canvas.width / gridSize)));
      food.y.push(Math.floor(Math.random() * (canvas.height / gridSize)));
    }

    if (score >= 10) {
      foodCount = Math.floor(score / 10) + 1;
    }
  }

  function checkCollision() {
    const head = snake[0];

    if (
      head.x < 0 ||
      head.y < 0 ||
      head.x >= canvas.width / gridSize ||
      head.y >= canvas.height / gridSize
    ) {
      clearInterval(gameInterval);
      alert("Game over!");
    }

    for (let i = 1; i < snake.length; i++) {
      if (snake[i].x === head.x && snake[i].y === head.y) {
        clearInterval(gameInterval);
        alert("Game over!");
        break;
      }
    }
  }

  function handleKeyPress(event) {
    switch (event.key) {
      case "ArrowUp":
        direction = "up";
        break;
      case "ArrowDown":
        direction = "down";
        break;
      case "ArrowLeft":
        direction = "left";
        break;
      case "ArrowRight":
        direction = "right";
        break;
    }
  }

  function startGame() {
    document.addEventListener("keydown", handleKeyPress);
    generateFood();
    gameInterval = setInterval(() => {
      moveSnake();
      checkCollision();
    }, 150);
  }

  startGame();
</script>
</body>
</html>
